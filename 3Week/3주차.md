# 실습 로컬 환경 
Apple M2 Max 

# 목표 
- 3주차 : Networking - 노드에 파드들간 통신 상세 1 (Routing, IPAM, Masquerading)

# 실습 환경 구성 

[[3Week/실습 환경]] 
[[1Week/실습 환경]]
* 기본 배포 가상 머신 : k8s-ctr, k8s-w1, **router**
- router : 사내망 10.10.0.0/16 대역 통신과 연결, k8s 에 join 되지 않은 서버, loop1/loop2 dump 인터페이스 배치
- Cilium CNI 설치 상태로 배포 완료됨
- K8S Args 설정 
- Prometheus & Grafana 
- Local Path Storage 

[[k9s]]
[[termshark]]

# IPAM
[[IPAM]]
[[IPAM#^7af1b0]] Kubernetes Host Scope
[[IPAM#^4a689c]] [Cilium] Cluster Scope & 마이그레이션 실습
[[IPAM#^41490d]] [Cilium]CNI Chaining
[[IPAM-MultiPool]]
# Routing
[[Routing#^12740c]] Encapsulation
[[Routing#^a7118d]] Native-Routing : PodCIDR
[[Cilium Agent 단축키 지정]]
# Masquerading
[[Masquerading]]

Native-Routing 환경에서 ip-masq로 사내망과 NAT 없는 통신 설정 시, 각 Node별 PodCIDR에 대한 라우팅 설정이 사내망 네트워크 장비에 필요. Static Routing이 사실상 Node가 많아질수록 운영상 불가능하여 동적으로 라우팅이 가능한 BGP를 사용하여 설정하는데 실 운영 환경에서 사용하는가 ? 
[[FRR]] + [[BGP, BFD]]

# CoreDNS, NodeLocalDNS
[[CoreDNS]]
[[NodeLocalDNS]]
[[NodeLocalDNS#^bd1807]] NodeLocalDNS 실습 + Cilium Local Redirect Policy